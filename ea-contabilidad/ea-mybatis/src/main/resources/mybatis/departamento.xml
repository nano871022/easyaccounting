<?xml version = "1.0" encoding = "UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="co.com.japl.ea.dto.dto.departamento">

	<insert id="insert"
		parameterType="co.com.japl.ea.dto.dto.DepartamentoDTO">
		INSERT INTO TBL_DEPARTAMENT
		(scode
		,sname
		,scountry	
		,dcreate
		,dupdate
		,ddelete
		,screater
		,supdater
		,sdeleter)
		VALUES
		(#{codigo}
		,#{nombre}
		,#{pais.codigo}
		,#{fechaCreacion}
		,#{fechaActualizacion}
		,#{fechaEliminacion}
		,#{creador}
		,#{actualizador}
		,#{eliminador});
	</insert>

	<select id="select"
		parameterType="co.com.japl.ea.dto.dto.DepartamentoDTO"
		resultMap="departametoResult">
		SELECT
		 a.scode as codigo
		,a.sname as nombre
		,p.scode as pais
		,a.dcreate as fechaCreacion
		,a.dupdate as fechaActualizacion
		,a.ddelete as fechaEliminacion
		,a.screater as creador
		,a.supdater as actualizador
		,a.sdeleter as eliminador
		FROM TBL_DEPARTAMENT a
		INNER JOIN TBL_COUNTRY p ON a.scountry = p.scode 
		<include refid="depwhere" ></include>
	</select>
	
	<resultMap type="co.com.japl.ea.dto.dto.DepartamentoDTO" id="departametoResult">
		<id column="scode" property="codigo"/>
		
	</resultMap>

	<select id="update"
		parameterType="co.com.japl.ea.dto.dto.DepartamentoDTO">
		UPDATE TBL_DEPARTAMENT
		SET
		scode = #{codigo}
		,sname = #{nombre}
		,scountry = #{pais.codigo}
		,dcreate = #{fechaCreacion}
		,dupdate = #{fechaActualizacion}
		,ddelete = #{fechaEliminacion}
		,screater = #{creador}
		,supdater = #{actualizador}
		,sdeleter = #{eliminador}
		<include refid="depwhere"></include>
	</select>

	<select id="select_count"
		parameterType="co.com.japl.ea.dto.dto.DepartamentoDTO"
		resultType="Integer">
		SELECT
		count(scode)
		FROM TBL_DEPARTAMENT
		<include refid="depwhere"></include>
	</select>
	<sql id="depwhere">
		<where>
			<if test="codigo != null">
				and a.scode = #{codigo}
			</if>
			<if test="nombre != null">
				and a.sname = #{nombre}
			</if>
			<if test="pais != null">
				and a.scountry = #{pais.codigo}
			</if>
		</where>
	</sql>



</mapper>